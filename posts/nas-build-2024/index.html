<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>2024 年的自建 NAS 不专业不完全手册 - Shawn's blog</title><meta name=Description content="分享我的知识、经验、生活与感悟"><meta property="og:url" content="https://blog.programmer.work/posts/nas-build-2024/"><meta property="og:site_name" content="Shawn's blog"><meta property="og:title" content="2024 年的自建 NAS 不专业不完全手册"><meta property="og:description" content="0X00 你需要一台 NAS 吗 不知怎么的，在移动互联网疯狂发展的今天，反而慢慢开始兴起了自建网络服务这种复古风潮。最近这些年身边的朋友同事越来越多聊到 NAS 了，甚至 B 站上出现了一小撮 NAS 区 UP 主（没错，你知道我说的是谁）。就更不说现在淘宝咸鱼上大量的 NAS 专用机箱，甚至是 3D 打印的定制化版本了。"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-02T13:48:00+00:00"><meta property="article:modified_time" content="2025-01-16T09:47:45+00:00"><meta property="article:tag" content="NAS"><meta property="og:image" content="https://blog.programmer.work/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.programmer.work/logo.png"><meta name=twitter:title content="2024 年的自建 NAS 不专业不完全手册"><meta name=twitter:description content="0X00 你需要一台 NAS 吗 不知怎么的，在移动互联网疯狂发展的今天，反而慢慢开始兴起了自建网络服务这种复古风潮。最近这些年身边的朋友同事越来越多聊到 NAS 了，甚至 B 站上出现了一小撮 NAS 区 UP 主（没错，你知道我说的是谁）。就更不说现在淘宝咸鱼上大量的 NAS 专用机箱，甚至是 3D 打印的定制化版本了。"><meta name=application-name content="Shawn's blog"><meta name=apple-mobile-web-app-title content="Shawn's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.programmer.work/posts/nas-build-2024/><link rel=prev href=https://blog.programmer.work/posts/python-faker-library/><link rel=next href=https://blog.programmer.work/posts/2024-summary/><link rel=stylesheet href=/css/style.min.a118a80f53dfc7454ebe6058a7521ec2b9a7a11acddb327fefe07b8bf30632d2.css integrity="sha256-oRioD1Pfx0VOvmBYp1IewrmnoRrN2zJ/7+B7i/MGMtI="><link rel=preload href=/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0="></noscript><link rel=preload href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"2024 年的自建 NAS 不专业不完全手册","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.programmer.work\/posts\/nas-build-2024\/"},"genre":"posts","keywords":"NAS","wordcount":4517,"url":"https:\/\/blog.programmer.work\/posts\/nas-build-2024\/","datePublished":"2024-07-02T13:48:00+00:00","dateModified":"2025-01-16T09:47:45+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shawn"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script defer src=https://umami.just666.com/script.js data-website-id=627dda02-a907-4b89-91da-4a1e031a013e></script><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">2024 年的自建 NAS 不专业不完全手册</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://blog.programmer.work title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Shawn</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-07-02>2024-07-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 4517 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 10 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#cpu>CPU</a></li><li><a href=#内存>内存</a></li><li><a href=#主板>主板</a></li><li><a href=#电源>电源</a></li><li><a href=#硬盘>硬盘</a></li><li><a href=#网络>网络</a></li></ul><ul><li><a href=#truenas-scale>TrueNAS SCALE</a></li><li><a href=#unraid>Unraid</a></li></ul></nav></div></div><div class=content id=content><h1 id=0x00-你需要一台-nas-吗>0X00 你需要一台 NAS 吗</h1><p>不知怎么的，在移动互联网疯狂发展的今天，反而慢慢开始兴起了自建网络服务这种复古风潮。最近这些年身边的朋友同事越来越多聊到 NAS 了，甚至 B 站上出现了一小撮 NAS 区 UP 主（没错，你知道我说的是谁）。就更不说现在淘宝咸鱼上大量的 NAS 专用机箱，甚至是 3D 打印的定制化版本了。</p><p>你真的需要一台 NAS 吗？NAS 说白了就是一块连着网的硬盘，速度比直接插电脑上还慢一些，如果你平日里需要访问数据的设备并不多，且拥有一个台式电脑，那不如先买两块硬盘插上去。通过文件共享功能将台式机转换成一个带有存储功能的兼职 NAS。</p><p>如果你家里的多个手机、平板、电脑、电视都需要访问存储，或者你没有台式机可以扩容，那确实可以考虑搞一台 NAS。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png title=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-dashboard.png></p><p>我自己的需求是这样的：</p><ul><li>平时喜欢摄影，每次拍摄回来的照片少则 10G 多则 50G，日积月累已经有大几百 G 了，需要备份</li><li>也喜欢拍一些视频，相机拍摄的码率都很高，随随便便 50G 100G 的，需要备份</li><li>患有仓鼠症，喜欢囤一些高清电影电视剧来看，总共搞了有差不多 8T 了</li><li>手机、平板、电视、电脑都需要访问上面的影视资源</li></ul><p>什么，你说你就是想要，不管需求？那就买呀，挑着贵的和好玩的买～</p><h1 id=0x01-我的-nas-之路>0X01 我的 NAS 之路</h1><p>最早的一台 NAS 是 2018 年买的 Synology DS118 性能烂到家了，也只有一个盘位，配了一块 4T 红盘，不过还是老老实实用了差不多 3 年。</p><p>DS118 存储告急之后打算升级 NAS，觉得自己很少用得上群晖引以为豪的软件，再加上对自己的技术实力有一捏捏🤏的信心，所以开始尝试自组 NAS。硬件选择了奔腾 G6400 + 16G 内存，第一次使用了 OMV ，觉得它对 Linux 的改动很少，所以相对来说更玩得惯。不过用了没多久还是换成了 TrueNAS Core，这套平台就稳定运行了很久。</p><blockquote><p>当时买了 8T 的 HC320，买了没几天奇亚币就上天了，我的硬盘价格也跟着上天了。时隔一周，我 899 买的硬盘店家就卖 1899 了 🤷‍♂️</p></blockquote><p>因为 TrueNAS Core 是基于 BSD 的系统，后来看 TrueNAS SCALE（基于 Linux 的）稳定了之后就切到了 SCALE 版本，也顺势将 G6400 升级成了 i3-10100，内存也加到了 32G。</p><p>升级之后的 NAS 一直稳定运行到了今年，突然有一天我觉得家里另外一台用作 homelab 的服务器开机时间太少了，然后我看着身边的一台性能「强劲」的 homelab 和一台性能「羸弱」的 NAS 陷入了沉思。沉思过后，从兜里掏出了一张「融合」：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png title=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/ronghe.png></p><h1 id=0x02-有点强的硬件配置>0X02 有点强的硬件配置</h1><p>说是融合，其实就是选用了 homelab 的 CPU内存主板和原 NAS 的机箱硬盘，大概配置如下</p><table><thead><tr><th>Name</th><th>Model</th></tr></thead><tbody><tr><td>CPU</td><td>AMD Epyc 7551P 32C64T</td></tr><tr><td>主板</td><td>SuperMicro H11SSL-i</td></tr><tr><td>内存</td><td>DDR4 16G ECC * 4</td></tr><tr><td>HDD</td><td>HC320 8T * 3</td></tr><tr><td>HDD</td><td>红盘 4T * 1</td></tr><tr><td>HDD</td><td>银河 4T * 1</td></tr><tr><td>SSD</td><td>Intel 1.6T</td></tr><tr><td>网卡</td><td>Intel 2.5G</td></tr><tr><td><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png title=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-configure.png></td><td></td></tr></tbody></table><p>试问哪个程序员不想要一台 32 核 64 线程 64G 内存 近 30T 存储容量的 NAS 呢 🤣</p><blockquote><p>配置单疑点：真有必要上这种 CPU 吗？没有，完全没有，事实上是之前 i3-10100 应付我的需求也完全没有任何问题。我只是正好有这个，卖也不怎么值钱，不如装上。真有必要上 64G 内存吗？没有，完全没有，事实上之前 32G 内存 应付我的需求也完全没有任何问题。我只是&mldr;有点上头，所以上了 64G。真有必要搞这么多存储吗？没有，完全没有，事实上🤦‍♂️这个还是有的，或者说因人而异，毕竟我确实要存好多照片、视频和电影电视剧。听说 HC320 很拉？其实我没觉得，所谓炒豆子声确实存在一些，不过也只存在于读写的时候，但是 NAS 其实大多数时候磁盘是可以休眠的。另外我放在桌子下面使用完全不会在意，只要别放卧室就没有问题。你那个 1.6T 是不是有点扎眼？这是我在咸鱼上收的二手，当时放在 homelab 上用的，现在拿过来做缓存（缓存意味着丢了也问题不大），正经自己配置缓存的话一般 250G 就妥妥够用了。</p></blockquote><h1 id=0x03-硬件选择>0X03 硬件选择</h1><p>我这个硬件配置其实也就图一乐，对大多数朋友的选购并不能起到多大的帮助作用。这一节来简单帮大家分析一下需求，选择自己需要的配置。</p><h2 id=cpu>CPU</h2><p>如果没有万兆传输需求，那 300 块钱买一个 G6400 或者同等水平的 CPU 就可以了，如果有万兆需求的话可能 CPU 性能上需要再上一档。</p><p>另外挑选 CPU 的时候可以注意一下它的编解码性能，如果性能达标的话在 NAS 上做视频转码就舒服多了。</p><h2 id=内存>内存</h2><p>内存主要就是看大小，如果你不打算用 TrueNAS 且不打算跑好多个服务在 NAS 上的话，4G 或者 8G 内存就是够用的。如果打算用 TrueNAS 的话可以在预算范围内多购置一些内存，有关系统选择的内容我写在下面了。</p><blockquote><p>有必要 ECC 吗？可以，但没必要。随便买几根内存插上就行了，真想讲究的话就买同品牌同频率同型号的内存。</p></blockquote><h2 id=主板>主板</h2><p>主板要在预算范围内选靠谱一些的，劣质主板的供电可能会有问题，这对于我们这种 7*24 运行的机器来说是很大的问题了。</p><p>另外如果计划加的硬盘多的话要先看一下硬盘供电和 SATA 接口是不是够用，不够的话还要买 PCIE 转接卡。</p><h2 id=电源>电源</h2><p>电源更好选，我们选一个转换率达标的<strong>大牌</strong> 就好了，功率反而是最不重要的。另外我建议各位选购全模组电源，因为我们大概率是不会给 NAS 装显卡的，用上全模组电源就可以让机箱里少很大一坨线。</p><p>现在我用的就是非模组电源，机箱里一大坨一大坨的供电线闲着用不上，徒增散热难度。</p><h2 id=硬盘>硬盘</h2><p>硬盘就在淘宝上找那几个口碑好的店去买就好了，既然组 NAS 了我建议还是 4T 起步，8T 10T 16T 最好。</p><p>如果需要缓存盘的话，要考虑自己是否会上万兆，如果是万兆内网的话一定要上 nvme 的盘，否则 SATA 的 SSD 就可以用作缓存了。因为 SATA 3.0 的速度是 6 Gbps 要高于常见的千兆、2.5G 和 5G，但是不到万兆的 10G。</p><h2 id=网络>网络</h2><p>网络基本上有四个选择，大家可以根据自己的需求进行选择：</p><ul><li>Wi-Fi <strong>愚蠢之选</strong> ：速度慢且不稳定，NAS 系统对 Wi-Fi 的支持也不好，没有任何理由选择为 NAS 配置 Wi-Fi；</li><li>千兆 <strong>新手之选</strong> ：不改动网络，不新增设备，125mb/s 的速度能满足几乎所有功能性需求；</li><li>2.5G <strong>实用之选</strong> ：2.5G 的网卡和交换机都不算贵，能将内网速度提升一倍不止，性价比很高；</li><li>万兆 <strong>高玩之选</strong> ：如果经常有大量数据传输的需求，那可以咬咬牙上万兆，100G 的数据也能一分多钟搞定，不过一般玩家就不太建议这么搞了，太贵；</li></ul><blockquote><p>你说还有 40G ？散了散了，买不起了 🤷‍♂️</p></blockquote><h1 id=0x04-系统选择>0X04 系统选择</h1><p>自组 NAS 的话基本上就下面这几种系统方案：</p><ul><li>TrueNAS Core <strong>稳如老狗</strong> ：企业级的 NAS 系统，基于 BSD，原生 ZFS，稳如老狗。不过没什么可玩性，如果是用作纯 NAS 的话可以考虑；</li><li>TrueNAS SCALE <strong>稳中带皮</strong> ：同样的企业级 NAS 系统，基于 Linux，也很稳定，比 Core 版的可玩性强一些，带 Docker；</li><li>OMV <strong>简单粗暴</strong> ：一个相对简单的系统，基于 Debian，没有深度用过，不过用户量也不是很大；</li><li>WIndows Server <strong>熟悉的地方</strong> ：有些用户对 Windows 很熟悉，对 Linux 则一窍不通，那其实装个 Windows 开启文件共享也挺好的，还免了后续的折腾；</li><li>Linux <strong>硬核之选</strong> ：如果你对自己的 Linux 技术有信心，是可以直接装 Linux 然后自己配置文件共享的，这样还更自由，只是 web 面板的缺失会导致修改配置和部署服务的麻烦程度直线提升；</li><li>Unraid <strong>玩家之选</strong> ：Unraid 是除了 Windows 以外唯一一个付费系统，可以方便的配置 Docker 和虚拟机，也有应用商店可以快速安装一些诸如 Plex、qbittorrent 之类的应用；</li></ul><p>按个人使用经验来说，比较推荐 <strong>TrueNAS SCALE</strong> 和 <strong>Unraid</strong> 两个。</p><h2 id=truenas-scale>TrueNAS SCALE</h2><p>优势：</p><ol><li>开源且免费</li><li>ZFS 很屌</li><li>带有插件市场，方便安装插件</li><li>支持在 NAS 上部署虚拟机</li></ol><p>劣势：</p><ol><li>上手难度较高</li><li>ZFS 并不适合所有人</li><li>ZFS 对内存要求较大</li><li>插件市场并不很完善</li></ol><h2 id=unraid>Unraid</h2><p>优势：</p><ol><li>阵列系统自由度高</li><li>上手门槛低</li><li>插件市场相比 TrueNAS 更完善</li><li>中文化做的更好</li><li>管理界面更加直观</li><li>也能部署虚拟机</li></ol><p>劣势：</p><ol><li>要钱，现在还改成了订阅制（可以去咸鱼收老的激活码）</li><li>对 ZFS 支持不佳</li><li>在使用校验盘且没有缓存的情况下写入速度慢</li></ol><h1 id=0x05-阵列介绍unraid-only>0X05 阵列介绍（Unraid Only）</h1><p>这里简单介绍一下 Unraid 的阵列，严格来说不叫阵列，应该是 Array。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png title=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/unraid-main.png></p><p>我们以 3 块 8T 的硬盘为例，如果组成无校验的 Array，可用空间就是 3*8=24T。向其中存储的文件会<strong>以文件为尺度分散在所有硬盘中</strong> ，这种方式的特点就是：<strong>读写的速度都是单盘的速度</strong> 。并且数据安全性上也比较特别，由于都是以文件为尺度进行分盘的，所以即使 3 块盘坏了 2 块，那活着的盘里的数据也还能都取出来，极端点说 100 快盘坏了 99 个，最后那个活着的也能读数据出来。这就是 Unraid 的特性。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png title=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/2024/jiou.png></p><p>还是 3 块 8T 的盘，如果将其中一个用作<strong>校验盘</strong> ，那可用空间就是 2*8=16T。存储的文件依旧以文件为尺度分散在硬盘中，但是每次写入数据到「数据盘」时，都会同时计算校验值写入「校验盘」。我们假设数据盘 A 存储了<code>[01010101]</code>的数据，数据盘 B 存储了 <code>[01100110]</code> 的数据，那经过计算我们校验盘就会存储 <code>[00110011]</code>（通过计算对应位置的二进制得到的）。这样一来 2 块数据盘无论坏掉哪一个，都可以根据另一个好的和校验盘进行计算将其数据恢复出来；如果校验盘坏了，那数据本身就没有丢，再替换一块校验盘上去即可。带校验的模式也有一点风险，就是「如果只有校验盘活下来」的情况，这种情况虽然校验盘活下来了，但是数据还是全都丢完了。</p><p>一般来说你都用 NAS 了，想必是对数据安全有一定要求的，所以建议 Unraid 配合校验盘一起使用，担心性能问题大不了再加一个缓存盘就是了。</p><h1 id=0x06-阵列介绍truenas-only>0X06 阵列介绍（TrueNAS Only）</h1><p>选择 TrueNAS 肯定是要用 ZFS 的，我们一般用 ZFS 也就这几种用法：strpe, mirror, raid-z, raid-z2。严格来说这些阵列方案和常见的 RAID 是不一样的，但也大差不差，所以我还是写了这个简易的对照表，方便各位理解。</p><table><thead><tr><th>ZFS Name</th><th>RAID Name</th></tr></thead><tbody><tr><td>strpe</td><td>raid-0</td></tr><tr><td>mirror</td><td>raid-1</td></tr><tr><td>raid-z</td><td>raid-5</td></tr><tr><td>raid-z2</td><td>raid-6</td></tr></tbody></table><p>还是那句话，你都用 NAS 了，想必是对数据安全有一定要求的，所以直接抛弃 strpe 这种一损俱损的疯狂模式，我们从 mirror 开始介绍。</p><p>mirror 是最简单的，就是纯镜像。我们依旧假设你有 3 个 8T 盘，现在将他们组成 ZFS mirror 之后可用空间就只有 8T，但是安全性暴涨。mirror 模式会将写入阵列的数据同时写入到所有磁盘，也就是说每个盘里都有完整的数据，这样一来 3 块盘只要没有一起挂掉，那数据就全部还在，是<strong>数据安全性最高</strong> 的。</p><p>raid-z 则是带校验的，但是与 Unraid 不同，<strong>raid-z 不存在校验盘的概念</strong> 。三块盘的身份是相同的，功能也是一样的，你写入的数据会分散在两块盘中，再将校验数据写入另一块盘。这种方式乍一看和 Unraid 上使用单个校验盘是一样的，但其实大相径庭。由于数据分散在三块盘中，校验数据也分散在三块盘中，这就意味着读写都是三块盘一起工作的，所以<strong>性能比带校验的 3 盘 Unraid 强</strong> 好多。但是当同时坏掉两块盘的时候，不能像 Unraid 一样有概率恢复一半数据。</p><p>raid-z2 则是带两个校验的，通常只有硬盘数更多时（例如 5 块）才会考虑，原理同上。带两个校验盘就意味着整个阵列中可以坏掉随意两块盘。</p><h1 id=0x07-装都装了-跑个服务吧>0X07 装都装了 跑个服务吧</h1><p>如果你的 NAS 性能比较强，有多余的性能可以跑一些服务的话，我可以推荐一下我部署的服务：</p><ul><li>Plex 影音中枢，可以将自己下载好的电影电视剧做成海报墙，并且在多个设备上无间断播放，需要在电视电脑平板手机等多设备上观看的话还是很好用的；</li><li>FileBrowser 文件管理器，虽然可以通过 SMB 协议挂载目录到手机电脑上，但偶尔不方便挂载的时候可以用它管理文件；</li><li>cailbre-web 电子书管理器，类似于 Plex，不过它是针对电子书的，可以在线看书、管理、收藏；</li><li>firefox 有点离谱，但是 Firefox 可以跑在浏览器里，我把 Firefox 通过 frp 做了内网透传，这样人在外面只需要访问这个 Firefox 服务就能间接访问家里部署的所有 web 服务了；</li><li>frp 内网穿透，允许你通过自建的服务器转发流量到家中，实现远程访问家里 NAS 的功能；</li><li>homeassistant 智能家居，还没深度使用，不过多介绍；</li><li>netdata 性能监控，说实话没什么用，但是看着帅；</li><li>qbittorrent BT 下载神器，没有介绍的必要；</li><li>SpeedTest 测速工具，用来测试内网速度是否达标</li></ul><h1 id=0x08-冷静消费>0X08 冷静消费</h1><p>一波分析后蠢蠢欲动？<strong>冷静，冷静，冷静</strong></p><p>开搞之前先问自己几个问题：</p><ol><li>真的有那么多的文件要存储吗？</li><li>真的有那么多的数据要备份吗？</li><li>真的有那么多的设备要访问吗？</li><li>电脑加硬盘的方案真的不行吗？</li></ol><p>如果真的都考虑清楚了，那就开搞吧～</p><p>最后提醒一句<strong>数据无价，做好备份</strong></p></div><style>.reward-container{max-width:500px;margin:50px auto;padding:30px;text-align:center;background:0 0;border-radius:12px}.reward-title{font-size:20px;margin-bottom:30px}.reward-icons{display:flex;justify-content:center;gap:40px}.reward-item{position:relative;cursor:pointer}.reward-item img{width:60px;height:60px;transition:transform .3s}.reward-item:hover img{transform:scale(1.1)}.qrcode{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);background:#fff;padding:15px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.15);opacity:0;visibility:hidden;transition:all .3s}.reward-item:hover .qrcode{opacity:1;visibility:visible}.qrcode img{width:200px;height:200px;display:block}</style><div class=reward-container><div class=reward-title>☕ 如果喜欢这篇文章，欢迎打赏 5 毛钱</div><div class=reward-icons><div class=reward-item><img src=/alipay-logo.png alt=支付宝><div class=qrcode><img src=/alipay-qr.jpeg alt=支付宝二维码></div></div><div class=reward-item><img src=/trc20-logo.png alt=USDT><div class=qrcode><img src=/usdt-qr.jpeg alt=USDT二维码></div></div><div class=reward-item><img src=/wechatpay-logo.png alt=微信><div class=qrcode><img src=/wechat-qr.jpeg alt=微信二维码></div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2025-01-16</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/nas/>NAS</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/python-faker-library/ class=prev rel=prev title="假数据制造机：Python 中的 Faker 库"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>假数据制造机：Python 中的 Faker 库</a>
<a href=/posts/2024-summary/ class=next rel=next title="2024 年度总结">2024 年度总结<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=gitalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/gitalk/gitalk></a>Gitalk</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Shawn 💗 Amber</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2015 - 2026</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.programmer.work target=_blank>Shawn</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/gitalk/gitalk.min.7a92033a32beba2a57cd417e2d5ab7ac2a45bf5111227648ac274b81e6a6cf57.css integrity="sha256-epIDOjK+uipXzUF+LVq3rCpFv1ERInZIrCdLgeamz1c="><link rel=stylesheet href=/lib/katex/katex.min.76e39bd605d45b2d1944123c66608b0c8bb9baeb70720b212571531c7cf9bc2a.css integrity="sha256-duOb1gXUWy0ZRBI8ZmCLDIu5uutwcgshJXFTHHz5vCo="><link rel=stylesheet href=/some.4187f1011616875f9033a8af97475eb55b97ed2f80267e22df0cd8305de45cc8.css integrity="sha256-QYfxARYWh1+QM6ivl0detVuX7S+AJn4i3wzYMF3kXMg="><script type=text/javascript src=/lib/gitalk/gitalk.min.3e68fce688cb68f396c11b65309c267b307f420f01cef269e5e4f3bd769801f0.js integrity="sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.3d9120fa621da6d613c1698b7014ec6bdf4620366e8f2b7b547059f4b6f6272b.js integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys="></script><script type=text/javascript src=/lib/clipboard/clipboard.min.e17a1d816e13c0826e0ed7febfabc3277f45571234bde0bf9120829a7169edc9.js integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck="></script><script type=text/javascript src=/lib/katex/katex.min.eb18207487161674e717087c317db14ac1a62dadaecccb802499ce173bfeb739.js integrity="sha256-6xggdIcWFnTnFwh8MX2xSsGmLa2uzMuAJJnOFzv+tzk="></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.cb7f4ca60ed5dc3e258415f8c7a3b46d4a93578a52adf83011f18a7f190e7602.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.52ce78fab4860d24ef22128a52ce24ca01368a9034457a565a1d3fccbab0ddbb.js integrity="sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.5c0a121a8b490afc85860a522347aeb34fb508c6b23044e5d29f6b2194227b51.js integrity="sha256-XAoSGotJCvyFhgpSI0eus0+1CMayMETl0p9rIZQie1E="></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{gitalk:{admin:["shawn-bluce"],clientID:"Ov23ligzD7mU8WBsue6H",clientSecret:"a832d1ba967e3a40f5485aa05e2a9e76f2d77901",id:"2024-07-02T13:48:00Z",owner:"shawn-bluce",repo:"shawn-bluce.github.io",title:"2024 年的自建 NAS 不专业不完全手册"}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.612a51a43205bbcf3b4af348dc2e8aa60f77f4fe5535ebc57f13054b61607d6c.js integrity="sha256-YSpRpDIFu887SvNI3C6Kpg939P5VNevFfxMFS2FgfWw="></script></body></html>