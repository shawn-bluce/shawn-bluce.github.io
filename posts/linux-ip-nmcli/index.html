<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络 - Shawn's blog</title><meta name=Description content="分享我的知识、经验、生活与感悟"><meta property="og:url" content="https://blog.programmer.work/posts/linux-ip-nmcli/"><meta property="og:site_name" content="Shawn's blog"><meta property="og:title" content="使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络"><meta property="og:description" content="0X00 查看网络配置文件 在CentOS中网络是以配置文件的形式存在系统里的，在/etc/sysconfig/network-scripts/目录下，一般情况下网卡的配置文件都在这里了，以ifcfg-就是配置文件了，打开配置文件看一下。下面注释一下关键的配置项"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-10-28T09:42:00+00:00"><meta property="article:modified_time" content="2025-01-16T09:30:49+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Network"><meta property="og:image" content="https://blog.programmer.work/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.programmer.work/logo.png"><meta name=twitter:title content="使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络"><meta name=twitter:description content="0X00 查看网络配置文件 在CentOS中网络是以配置文件的形式存在系统里的，在/etc/sysconfig/network-scripts/目录下，一般情况下网卡的配置文件都在这里了，以ifcfg-就是配置文件了，打开配置文件看一下。下面注释一下关键的配置项"><meta name=application-name content="Shawn's blog"><meta name=apple-mobile-web-app-title content="Shawn's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.programmer.work/posts/linux-ip-nmcli/><link rel=prev href=https://blog.programmer.work/posts/python-exception-simple/><link rel=next href=https://blog.programmer.work/posts/linux-acl/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.programmer.work\/posts\/linux-ip-nmcli\/"},"genre":"posts","keywords":"Linux, Network","wordcount":2432,"url":"https:\/\/blog.programmer.work\/posts\/linux-ip-nmcli\/","datePublished":"2016-10-28T09:42:00+00:00","dateModified":"2025-01-16T09:30:49+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shawn"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://blog.programmer.work title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Shawn</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2016-10-28>2016-10-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 2432 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#查看网络>查看网络</a></li><li><a href=#开关网络>开关网络</a></li><li><a href=#配置网络>配置网络</a></li></ul><ul><li><a href=#ip命令管理设备开关>ip命令管理设备开关</a></li><li><a href=#ip命令修改网卡mac地址>ip命令修改网卡MAC地址</a></li></ul><ul><li><a href=#查看网络接口状态>查看网络接口状态</a></li><li><a href=#查看修改主机名>查看修改主机名</a></li><li><a href=#查看网络设备>查看网络设备</a></li><li><a href=#修改网卡配置>修改网卡配置</a></li></ul></nav></div></div><div class=content id=content><h1 id=0x00-查看网络配置文件>0X00 查看网络配置文件</h1><p>在CentOS中网络是以配置文件的形式存在系统里的，在<code>/etc/sysconfig/network-scripts/</code>目录下，一般情况下网卡的配置文件都在这里了，以<code>ifcfg-</code>就是配置文件了，打开配置文件看一下。下面注释一下关键的配置项</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    TYPE<span style=color:#f92672>=</span>Ethernet	<span style=color:#75715e># 网络类型</span>
</span></span><span style=display:flex><span>    BOOTPROTO<span style=color:#f92672>=</span>static	<span style=color:#75715e># 协议取值，常见的是static和dhcp</span>
</span></span><span style=display:flex><span>    IPADDR<span style=color:#f92672>=</span>10.13.7.33	<span style=color:#75715e># 给网卡ip赋值</span>
</span></span><span style=display:flex><span>    NETMASK<span style=color:#f92672>=</span>255.255.255.0	<span style=color:#75715e># 给网卡子网掩码赋值</span>
</span></span><span style=display:flex><span>    DEFROUTE<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    PEERDNS<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    PEERROUTES<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV4_FAILURE_FATAL<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>    IPV6INIT<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV6_AUTOCONF<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV6_DEFROUTE<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV6_PEERDNS<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV6_PEERROUTES<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>    IPV6_FAILURE_FATAL<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>    NAME<span style=color:#f92672>=</span>enp0s8
</span></span><span style=display:flex><span>    USERCTL<span style=color:#f92672>=</span>no	<span style=color:#75715e># 是否允许非root用户控制</span>
</span></span><span style=display:flex><span>    UUID<span style=color:#f92672>=</span>4c967913-c4c9-4961-ae03-de7865f144d0	<span style=color:#75715e># 网卡的唯一标识码</span>
</span></span><span style=display:flex><span>    DEVICE<span style=color:#f92672>=</span>enp0s8	<span style=color:#75715e># 设备名</span>
</span></span><span style=display:flex><span>    ONBOOT<span style=color:#f92672>=</span>no	<span style=color:#75715e># 是否在开机时激活</span>
</span></span></code></pre></div><p>但是一般不建议直接使用编辑器修改网络配置文件，因为这样容易出现一些语法错误和逻辑错误，所以建议使用命令行来管理配置网络，虽然本质上都是去修改配置文件。但是使用命令行去管理网络，命令都是确保配置没有问题才会写入到文件，所以会更加安全。包括下面介绍的<code>ip</code>和<code>nmcli</code>命令，都是通过修改配置文件来完成功能的。</p><h1 id=0x01-ifconfig-命令>0X01 ifconfig 命令</h1><p>这个命令在CentOS7中已经不建议使用了，不过由于之前的版本都是在用这个命令，还是说一下。<code>ifconfig</code>是<code>interface configuration</code>的缩写，也就是接口配置。</p><h2 id=查看网络>查看网络</h2><p>直接输入这个命令就可以看到现在启动着的所有网络。也可以接上某个特定的网卡来查看单独的信息<code>ifconfig enp0s3</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    lo: flags<span style=color:#f92672>=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span style=color:#ae81ff>65536</span>
</span></span><span style=display:flex><span>            inet 127.0.0.1  netmask 255.0.0.0
</span></span><span style=display:flex><span>            inet6 ::1  prefixlen <span style=color:#ae81ff>128</span>  scopeid 0x10&lt;host&gt;
</span></span><span style=display:flex><span>            loop  txqueuelen <span style=color:#ae81ff>0</span>  <span style=color:#f92672>(</span>Local Loopback<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>如果想查看包括已经关闭了的网络时，使用<code>ifconfig -a</code>就可以了</p><blockquote><p>最后的那个lo是回环网络，暂时不用管</p></blockquote><h2 id=开关网络>开关网络</h2><p><code>ifconfig</code>还可以开关网络，命令后面接<code>interface name</code>也就是网卡名，然后接上<code>up/down</code>就可以开关网络了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8 down	# 关闭网络</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig</span>
</span></span><span style=display:flex><span>    lo: flags<span style=color:#f92672>=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span style=color:#ae81ff>65536</span>
</span></span><span style=display:flex><span>            inet 127.0.0.1  netmask 255.0.0.0
</span></span><span style=display:flex><span>            inet6 ::1  prefixlen <span style=color:#ae81ff>128</span>  scopeid 0x10&lt;host&gt;
</span></span><span style=display:flex><span>            loop  txqueuelen <span style=color:#ae81ff>0</span>  <span style=color:#f92672>(</span>Local Loopback<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8 up	# 打开网络</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            inet 123.123.123.2  netmask 255.255.255.128  broadcast 123.123.123.1
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    lo: flags<span style=color:#f92672>=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span style=color:#ae81ff>65536</span>
</span></span><span style=display:flex><span>            inet 127.0.0.1  netmask 255.0.0.0
</span></span><span style=display:flex><span>            inet6 ::1  prefixlen <span style=color:#ae81ff>128</span>  scopeid 0x10&lt;host&gt;
</span></span><span style=display:flex><span>            loop  txqueuelen <span style=color:#ae81ff>0</span>  <span style=color:#f92672>(</span>Local Loopback<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=配置网络>配置网络</h2><p><code>ifconfig</code>命令可以在不重启的情况下开关网络接口，修改IP、掩码、网关等信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8	# 查看ep0s8的网卡信息</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8 123.233.233.123	# 修改ip为123.233.233.123</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            inet 123.233.233.123  netmask 255.0.0.0  broadcast 123.255.255.255
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8 netmask 255.255.255.0	# 修改子网掩码为255.255.255.0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            inet 123.233.233.123  netmask 255.255.255.0  broadcast 123.233.233.255
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8 123.123.123.2 netmask 255.255.255.128	# 当然也可以把这些写成一行</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ifconfig enp0s8</span>
</span></span><span style=display:flex><span>    enp0s8: flags<span style=color:#f92672>=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>            inet 123.123.123.2  netmask 255.255.255.128  broadcast 123.123.123.
</span></span><span style=display:flex><span>            ether 08:00:27:79:c4:b1  txqueuelen <span style=color:#ae81ff>1000</span>  <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            RX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span>  overruns <span style=color:#ae81ff>0</span>  frame <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            TX packets <span style=color:#ae81ff>0</span>  bytes <span style=color:#ae81ff>0</span> <span style=color:#f92672>(</span>0.0 B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            TX errors <span style=color:#ae81ff>0</span>  dropped <span style=color:#ae81ff>0</span> overruns <span style=color:#ae81ff>0</span>  carrier <span style=color:#ae81ff>0</span>  collisions <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h1 id=0x02-nmtui-简单的类图形管理工具>0X02 nmtui 简单的类图形管理工具</h1><p>在终端中输入<code>nmtui</code>就可以打开一个类图形的界面，用这个界面可以更简单得管理配置网络，但是不能做比较细致的配置，而且使用比较简单，所以这里就不多做介绍了，可以自己在终端上打开看看。这个命令的一大优点是可以在ssh远程连接的时候使用，在Windows下的XShell等软件中都可以直接调出。</p><h1 id=0x03-ip-命令>0X03 ip 命令</h1><p>ip是现在推荐使用的命令，功能比较强大。</p><h2 id=ip命令管理设备开关>ip命令管理设备开关</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link show enp0s8	# 这个命令大致相当于 ifconfig enp0s8 查看这个网卡的信息</span>
</span></span><span style=display:flex><span>    3: enp0s8: &lt;BROADCAST,MULTICAST&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state DOWN mode DEFAULT qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        link/ether 08:00:27:79:c4:b1 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link set dev enp0s8 up	# 设置一个device，enp0s8，打开</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link show enp0s8</span>
</span></span><span style=display:flex><span>    3: enp0s8: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state DOWN mode DEFAULT qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        link/ether 08:00:27:79:c4:b1 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link set dev enp0s8 down	# 设置 设备 网卡名 打开/关闭</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link show enp0s8</span>
</span></span><span style=display:flex><span>    3: enp0s8: &lt;BROADCAST,MULTICAST&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state DOWN mode DEFAULT qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        link/ether 08:00:27:79:c4:b1 brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><h2 id=ip命令修改网卡mac地址>ip命令修改网卡MAC地址</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link set dev enp0s8 address 00:00:ff:bb:aa:22	# 修改网卡的物理地址，也就是MAC地址</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># ip link show enp0s8</span>
</span></span><span style=display:flex><span>    3: enp0s8: &lt;BROADCAST,MULTICAST&gt; mtu <span style=color:#ae81ff>1500</span> qdisc pfifo_fast state DOWN mode DEFAULT qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        link/ether 00:00:ff:bb:aa:22 brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><h1 id=0x04-nmcli-管理网络>0X04 nmcli 管理网络</h1><p><code>nmcli</code>是<code>network manager command line interface</code>的简写，这个命令可以用来管理配置网络。</p><h2 id=查看网络接口状态>查看网络接口状态</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli -p g</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>=============================================================</span>
</span></span><span style=display:flex><span>                        NetworkManager status
</span></span><span style=display:flex><span>    <span style=color:#f92672>=============================================================</span>
</span></span><span style=display:flex><span>    STATE      CONNECTIVITY  WIFI-HW  WIFI     WWAN-HW  WWAN
</span></span><span style=display:flex><span>    -------------------------------------------------------------
</span></span><span style=display:flex><span>    connected  full          enabled  enabled  enabled  enabled
</span></span></code></pre></div><h2 id=查看修改主机名>查看修改主机名</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli general hostname</span>
</span></span><span style=display:flex><span>    localhost.localdomain
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli general hostname test</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli general hostname</span>
</span></span><span style=display:flex><span>    test
</span></span></code></pre></div><h2 id=查看网络设备>查看网络设备</h2><p>以前可以用ifconfig来查看网络设备，ip命令也可以查看。可以直接查看所有的，也可以指定某一个设备查看。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli device show	# 莎看所有设备</span>
</span></span><span style=display:flex><span>    GENERAL.DEVICE:                         enp0s3
</span></span><span style=display:flex><span>    GENERAL.TYPE:                           ethernet
</span></span><span style=display:flex><span>    GENERAL.HWADDR:                         08:00:27:35:C7:CE
</span></span><span style=display:flex><span>    GENERAL.MTU:                            <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>    .......................	<span style=color:#75715e># 输出太多，就不全放在这里了</span>
</span></span><span style=display:flex><span>    IP6.ADDRESS<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                         ::1/128
</span></span><span style=display:flex><span>    IP6.GATEWAY:
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli device show enp0s8	# 查看指定设备</span>
</span></span><span style=display:flex><span>    GENERAL.DEVICE:                         enp0s8
</span></span><span style=display:flex><span>    GENERAL.TYPE:                           ethernet
</span></span><span style=display:flex><span>    GENERAL.HWADDR:                         08:00:27:79:C4:B1
</span></span><span style=display:flex><span>    GENERAL.MTU:                            <span style=color:#ae81ff>1500</span>
</span></span><span style=display:flex><span>    GENERAL.STATE:                          <span style=color:#ae81ff>100</span> <span style=color:#f92672>(</span>connected<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    GENERAL.CONNECTION:                     enp0s8
</span></span><span style=display:flex><span>    GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/7
</span></span><span style=display:flex><span>    WIRED-PROPERTIES.CARRIER:               off
</span></span><span style=display:flex><span>    IP4.ADDRESS<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span>:                         123.123.123.2/25
</span></span><span style=display:flex><span>    IP4.GATEWAY:
</span></span><span style=display:flex><span>    IP6.GATEWAY:
</span></span></code></pre></div><h2 id=修改网卡配置>修改网卡配置</h2><p>一个设备可以有多个连接，在CentOS7中网络是以连接管理的。虽然每个设备可以有多个连接，但是同时生效的只能有一个。我们可以使用<code>nmcli connection</code>查看连接</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection show</span>
</span></span><span style=display:flex><span>    NAME    UUID                                  TYPE            DEVICE
</span></span><span style=display:flex><span>    enp0s8  ae99f48d-5f20-4a9c-a487-c4ebafa3f92e  802-3-ethernet  enp0s8
</span></span><span style=display:flex><span>    enp0s3  2edc4731-888c-4102-8ff5-236ea47eeedb  802-3-ethernet  enp0s3
</span></span></code></pre></div><p>我们可以进行如下操作<code>nmcli connection add/delete/edit</code>也就是增删改三个操作。
每一个连接都有一个名字，我们可以根据名字索引来操作对应到的连接。我们先来删除掉之前配置的网络。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection delete enp0s8 	# 这样可以删掉之前的连接</span>
</span></span><span style=display:flex><span>    Connection <span style=color:#e6db74>&#39;enp0s8&#39;</span> <span style=color:#f92672>(</span>ae99f48d-5f20-4a9c-a487-c4ebafa3f92e<span style=color:#f92672>)</span> successfully deleted.
</span></span></code></pre></div><p>然后添加一个新的连接，名字叫&rsquo;test_conn&rsquo;，接口是&rsquo;enp0s8&rsquo;，类型是&rsquo;ethernet&rsquo;也就是以太网，ip使用v4版本123.123.123.123，子网掩码是24位，ipv4的网关是123.123.123.1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection add con-name &#39;test_conn&#39; ifname enp0s8 type ethernet ip4 123.123.123.123/24 gw4 123.123.123.1</span>
</span></span><span style=display:flex><span>    Connection <span style=color:#e6db74>&#39;test_conn&#39;</span> <span style=color:#f92672>(</span>05c7cd70-a48e-4a12-a0de-9d57724cf0d0<span style=color:#f92672>)</span> successfully added.
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection show test_conn</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 这行命令的输出太多了就不展示了。但是我们可以通过这行命令看到自己创建的连接，信息和自己填写的命令相对应。</span>
</span></span></code></pre></div><p>修改一个连接可以使用<code>nmcli connection modify</code>，下面我们来测试一下修改一个连接</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection show test_conn | grep ipv4.dns	# 使用grep搜索查看dns设置</span>
</span></span><span style=display:flex><span>    ipv4.dns:
</span></span><span style=display:flex><span>    ipv4.dns-search:
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection modify test_conn ipv4.dns 8.8.8.8	# 修改ipv4的dns地址</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># nmcli connection show test_conn | grep ipv4.dns</span>
</span></span><span style=display:flex><span>    ipv4.dns:                               8.8.8.8
</span></span><span style=display:flex><span>    ipv4.dns-search:
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2025-01-16</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/linux/>Linux</a>,&nbsp;<a href=/tags/network/>Network</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/python-exception-simple/ class=prev rel=prev title="Python 异常处理 捕获异常"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Python 异常处理 捕获异常</a>
<a href=/posts/linux-acl/ class=next rel=next title="Linux 权限控制列表 ACL">Linux 权限控制列表 ACL<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=gitalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/gitalk/gitalk></a>Gitalk</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.152.2">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2015 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.programmer.work target=_blank>Shawn</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/gitalk/gitalk.min.css><link rel=stylesheet href=/lib/katex/katex.min.css><script type=text/javascript src=/lib/gitalk/gitalk.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:50},comment:{gitalk:{admin:["shawn-bluce"],clientID:"Ov23ligzD7mU8WBsue6H",clientSecret:"a832d1ba967e3a40f5485aa05e2a9e76f2d77901",id:"2016-10-28T09:42:00Z",owner:"shawn-bluce",repo:"shawn-bluce.github.io",title:"使用 nmcli 和 ip 命令配置 CentOS/RHEL 的网络"}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>