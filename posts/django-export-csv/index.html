<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV - Shawn's blog</title><meta name=Description content="åˆ†äº«æˆ‘çš„çŸ¥è¯†ã€ç»éªŒã€ç”Ÿæ´»ä¸æ„Ÿæ‚Ÿ"><meta property="og:url" content="https://blog.programmer.work/posts/django-export-csv/"><meta property="og:site_name" content="Shawn's blog"><meta property="og:title" content="Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV"><meta property="og:description" content="0X00 å‰è¨€ ä¸€è§ç¨‹åºå‘˜ï¼Œç«‹åˆ»æƒ³åˆ° web å¼€å‘ï¼Œç«‹åˆ»æƒ³åˆ°åå°ç®¡ç†ç³»ç»Ÿï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®å±•ç¤ºï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç­›é€‰ç­›é€‰ï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç»Ÿè®¡ï¼Œç«‹åˆ»æƒ³åˆ°å¯¼å‡º Excel è¡¨æ ¼ã€‚äº§å“ç»ç†çš„æƒ³è±¡æƒŸåœ¨è¿™ä¸€å±‚èƒ½å¤Ÿå¦‚æ­¤è·ƒè¿›ã€‚ â€“é²è¿…ï¼šæˆ‘ä¸æ˜¯ï¼Œæˆ‘æ²¡æœ‰ï¼Œåˆ«çè¯´"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-28T14:40:00+00:00"><meta property="article:modified_time" content="2025-01-16T07:43:20+00:00"><meta property="article:tag" content="Django"><meta property="article:tag" content="CSV"><meta property="og:image" content="https://blog.programmer.work/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.programmer.work/logo.png"><meta name=twitter:title content="Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV"><meta name=twitter:description content="0X00 å‰è¨€ ä¸€è§ç¨‹åºå‘˜ï¼Œç«‹åˆ»æƒ³åˆ° web å¼€å‘ï¼Œç«‹åˆ»æƒ³åˆ°åå°ç®¡ç†ç³»ç»Ÿï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®å±•ç¤ºï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç­›é€‰ç­›é€‰ï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç»Ÿè®¡ï¼Œç«‹åˆ»æƒ³åˆ°å¯¼å‡º Excel è¡¨æ ¼ã€‚äº§å“ç»ç†çš„æƒ³è±¡æƒŸåœ¨è¿™ä¸€å±‚èƒ½å¤Ÿå¦‚æ­¤è·ƒè¿›ã€‚ â€“é²è¿…ï¼šæˆ‘ä¸æ˜¯ï¼Œæˆ‘æ²¡æœ‰ï¼Œåˆ«çè¯´"><meta name=application-name content="Shawn's blog"><meta name=apple-mobile-web-app-title content="Shawn's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.programmer.work/posts/django-export-csv/><link rel=prev href=https://blog.programmer.work/posts/django-api-fater-2/><link rel=next href=https://blog.programmer.work/posts/why-django-need-uwsgi/><link rel=stylesheet href=/css/style.min.a118a80f53dfc7454ebe6058a7521ec2b9a7a11acddb327fefe07b8bf30632d2.css integrity="sha256-oRioD1Pfx0VOvmBYp1IewrmnoRrN2zJ/7+B7i/MGMtI="><link rel=preload href=/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.0df5a33710e433de1f5415b1d47e4130ca7466aee5b81955f1045c4844bbb3ed.css integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0="></noscript><link rel=preload href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8=" as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.5fbaeb9f8e25d7e0143bae61d4b1802c16ce7390b96ceb2d498b0d96ff4c853f.css integrity="sha256-X7rrn44l1+AUO65h1LGALBbOc5C5bOstSYsNlv9MhT8="></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.programmer.work\/posts\/django-export-csv\/"},"genre":"posts","keywords":"Django, CSV","wordcount":1442,"url":"https:\/\/blog.programmer.work\/posts\/django-export-csv\/","datePublished":"2020-06-28T14:40:00+00:00","dateModified":"2025-01-16T07:43:20+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Shawn"},"description":""}</script></head><body data-header-desktop=auto data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"dark"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><script defer src=https://umami.just666.com/script.js data-website-id=627dda02-a907-4b89-91da-4a1e031a013e></script><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>æ–‡ç«  </a><a class=menu-item href=/tags/>æ ‡ç­¾ </a><a class=menu-item href=/about/>å…³äº </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Shawn's blog">Shawn's blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>æ–‡ç« </a><a class=menu-item href=/tags/ title>æ ‡ç­¾</a><a class=menu-item href=/about/ title>å…³äº</a><a href=javascript:void(0); class="menu-item theme-switch" title=åˆ‡æ¢ä¸»é¢˜>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>ç›®å½•</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://blog.programmer.work title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Shawn</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-06-28>2020-06-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;çº¦ 1442 å­—&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;é¢„è®¡é˜…è¯» 3 åˆ†é’Ÿ&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>ç›®å½•</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><h1 id=0x00-å‰è¨€>0X00 å‰è¨€</h1><blockquote><p>ä¸€è§ç¨‹åºå‘˜ï¼Œç«‹åˆ»æƒ³åˆ° web å¼€å‘ï¼Œç«‹åˆ»æƒ³åˆ°åå°ç®¡ç†ç³»ç»Ÿï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®å±•ç¤ºï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç­›é€‰ç­›é€‰ï¼Œç«‹åˆ»æƒ³åˆ°æ•°æ®ç»Ÿè®¡ï¼Œç«‹åˆ»æƒ³åˆ°å¯¼å‡º Excel è¡¨æ ¼ã€‚äº§å“ç»ç†çš„æƒ³è±¡æƒŸåœ¨è¿™ä¸€å±‚èƒ½å¤Ÿå¦‚æ­¤è·ƒè¿›ã€‚ &ndash;é²è¿…ï¼šæˆ‘ä¸æ˜¯ï¼Œæˆ‘æ²¡æœ‰ï¼Œåˆ«çè¯´</p></blockquote><p><img class=lazyload src=/svg/loading.min.svg data-src=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/20200628225253.jpg data-srcset="https://blog-1251664340.cos.ap-chengdu.myqcloud.com/20200628225253.jpg, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/20200628225253.jpg 1.5x, https://blog-1251664340.cos.ap-chengdu.myqcloud.com/20200628225253.jpg 2x" data-sizes=auto alt=https://blog-1251664340.cos.ap-chengdu.myqcloud.com/20200628225253.jpg title=æˆ‘ä¸æ˜¯ï¼Œæˆ‘æ²¡æœ‰ï¼Œåˆ«çè¯´å•Š></p><p>è™½ç„¶ä¸Šé¢è¿™ç§è¯´æ³•æœ‰ç‚¹å¤¸å¼ äº†ï¼Œä¸è¿‡ç¡®å®å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šäººåœ¨å·¥ä½œä¸­é‡åˆ°è¿‡ä¸æ­¢ä¸€æ¬¡çš„éœ€è¦åœ¨ä¸€ä¸ª web ç³»ç»Ÿé‡Œæ·»åŠ ä¸€ä¸ªâ€æ•°æ®å¯¼å‡ºâ€çš„åŠŸèƒ½ï¼Œè€Œä¸”é€šå¸¸éƒ½æ˜¯å¯¼å‡ºæˆ csv è¿™ç§æ–‡ä»¶ã€‚è‡ªç„¶æˆ‘ä¹Ÿé‡åˆ°äº†å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šæ¬¡ï¼Œä¹Ÿå†™è¿‡é‚£ç§æœ€è ¢çš„æ‰‹æ‹¼é€—å·çš„ csv å¯¼å‡ºï¼Œè¿˜çœ‹è¿‡åˆ«äººæ•ˆæœæ›´å¥½ä»£ç é‡æ›´å°‘çš„ç‰ˆæœ¬ã€‚ä¹Ÿå°±åœ¨æ­¤æ€»ç»“ä¸€ä¸‹å…·ä½“è¿™ä¸ª csv å¯¼å‡ºè¯¥æ€ä¹ˆææ‰å¥½ã€‚</p><p>æœ€è ¢çš„æ–¹æ¡ˆå¯èƒ½å°±æ˜¯æˆ‘æœ€æ—©å®ä¹ çš„æ—¶å€™å†™å‡ºæ¥çš„é‚£ç§æ‰‹æ‹¼é€—å·çš„æ–¹æ¡ˆäº†ï¼Œä¸ºäº†å¤§å®¶åˆšåƒçš„æ—©åˆæ™šé¥­ç€æƒ³ï¼Œå°±ä¸ç»™å¤§å®¶çœ‹äº†ï¼Œçœå¾—åå‡ºæ¥æµªè´¹ç²®é£Ÿã€‚çœŸæ­£ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯è¿™ä¹ˆä¸¤ç§ï¼šä¸€ç§æ˜¯ä¼ ç»Ÿçš„æ‹¼æ¥äºŒç»´æ•°ç»„çš„æ–¹å¼æ¥æ¨¡æ‹Ÿè¡¨æ ¼ï¼Œç„¶åé€šè¿‡ Python çš„ csv åº“ç›´æ¥å¯¼å‡ºï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨ djcsv æ¥è¿›è¡Œå¯¼å‡ºã€‚ä¸‹é¢æ¥ç®€å•çœ‹ä¸€ä¸‹å˜ã€‚</p><h1 id=0x01-åŸå§‹-csv-å¯¼å‡º>0X01 åŸå§‹ csv å¯¼å‡º</h1><p>å…¶å®ç®€å•çš„å¯¼å‡ºåŸå§‹çš„æ–¹æ³•å°±å¯ä»¥è§£å†³é—®é¢˜äº†ï¼Œä¸‹é¢åªåˆ—å‡ºé‡ç‚¹ä»£ç ã€‚é¦–å…ˆå¯¼å…¥ csv æ¨¡å—ï¼›ç„¶åæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨æ¥ä¿å­˜è¿™æ¬¡å¯¼å‡ºçš„å†…å®¹ï¼›æ¥ä¸‹æ¥æŒ‰è¡Œå†™å…¥è¡¨å¤´ï¼›ç„¶åå¾ªç¯æ•´ä¸ª queryset æ„å»ºä¸€è¡Œè¡Œçš„æ•°æ®ä»è€Œå†™å…¥ï¼›æœ€ç»ˆå¯¼å‡ºå°±æˆåŠŸç»“æŸäº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;export.csv&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f: <span style=color:#75715e># æ‰“å¼€å¾…ç”¨çš„æ–‡ä»¶</span>
</span></span><span style=display:flex><span>        csv_writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>writer(f)  <span style=color:#75715e># ç”Ÿæˆä¸€ä¸ª csvwriter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        table_title <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;å§“å&#39;</span>, <span style=color:#e6db74>&#39;æ€§åˆ«&#39;</span>, <span style=color:#e6db74>&#39;ç”Ÿæ—¥&#39;</span>]  <span style=color:#75715e># å‡†å¤‡è¡¨å¤´</span>
</span></span><span style=display:flex><span>        csv_writer<span style=color:#f92672>.</span>write_row(table_title)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        queryset <span style=color:#f92672>=</span> Student<span style=color:#f92672>.</span>objects<span style=color:#f92672>.</span>all()<span style=color:#f92672>.</span>only(<span style=color:#e6db74>&#39;name&#39;</span>, <span style=color:#e6db74>&#39;gender&#39;</span>, <span style=color:#e6db74>&#39;birthday&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> student <span style=color:#f92672>in</span> queryset:
</span></span><span style=display:flex><span>            line <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>                student<span style=color:#f92672>.</span>name,
</span></span><span style=display:flex><span>                student<span style=color:#f92672>.</span>gender,
</span></span><span style=display:flex><span>                student<span style=color:#f92672>.</span>birthday<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>&#39;</span>),
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>            csv_writer<span style=color:#f92672>.</span>write_row(line)
</span></span></code></pre></div><p>è¿™æ ·å¯¼å‡ºæ¥çš„æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å†…å®¹äº†ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€çœ¼æˆæœï¼ˆä¸æ˜¯è¯¸è‘›å¤§åŠ›ï¼Œæ˜¯æˆ‘ä»¬å¯¼å‡ºæ¥çš„ csv æ–‡ä»¶ğŸ¤£ï¼‰ï¼š å‘ç°é—®é¢˜äº†æ²¡ï¼Ÿæˆ‘ä»¬çš„æ€§åˆ«å‡ºç°äº†ä¸€ä¸¢ä¸¢é—®é¢˜ï¼Œæœ¬æ¥æ˜¯ç”¨ M/F æ¥å½“åšç”·å¥³æ¥å­˜çš„ï¼ˆè¿™ç§æƒ…å†µå…¶å®éå¸¸å¤šçš„ï¼Œæ¯”å¦‚ä½ çš„ç±»å‹å¯èƒ½ç”¨äº† integer ç„¶åç”¨ä¸€ä¸ª map å»æ˜ å°„åˆ°ä¸åŒçš„ä¸­æ–‡åä¸Šå»ï¼‰ï¼Œç°åœ¨å´æŠŠæ•°æ®åº“ä¸­çœŸå®çš„å†…å®¹å¯¼å‡ºæ¥äº†ã€‚</p><p>| å§“å | æ€§åˆ« | ç”Ÿæ—¥ |
| -â€”â€”â€”â€”â€” |
| Kevin Armstrong | F | 1988-01-02 |
| Patricia Robinson | F | 1988-01-02 |
| Michael Duffy | F | 1988-01-02 |
| Kathryn Hodge | M | 1988-01-02 |
| Justin Carlson | F | 1988-01-02 |
| Larry Jones | F | 1988-01-02 |
| Peter Palmer | F | 1988-01-02 |
| William Smith | F | 1988-01-02 |
| Karen Garcia | M | 1988-01-02 |
| Eric Williams | F | 1988-01-02 |
| Eduardo Bell | F | 1988-01-02 |
| Cynthia Lee | M | 1988-01-02 |
| Brandy Hoffman | F | 1988-01-02 |
| Emily Jones | F | 1988-01-02 |
| Kelly Perry | M | 1988-01-02 |
| Jamie Nixon | F | 1988-01-02 |
| Jeffrey Vega | F | 1988-01-02 |
| John Chen | M | 1988-01-02 |
| Laura Stevens | M | 1988-01-02 |
| Linda Robinson | M | 1988-01-02 |</p><p>å¦‚æœä½ è¯´è¿™ç§é—®é¢˜ä¸å¤§ï¼Œé‚£ç°åœ¨æˆ‘ä»¬è¦æ±‚åŠ ä¸€åˆ— â€æ˜¯å¦æˆå¹´â€œ ï¼Œç„¶åè¿™ä¸ªæ˜¯å¦æˆå¹´åˆæ²¡æœ‰å­˜ï¼Œåªæœ‰ç”¨ç”Ÿæ—¥æ¥è®¡ç®—ï¼Œé‚£å’‹æï¼Ÿå¯èƒ½åªæœ‰åœ¨<code>line = [xxxxx]</code>çš„åœ°æ–¹å†åŠ ä¸€è¡Œ<code>'æˆå¹´' if (datetime.datetime.now() - student.birthday).days / 365 >= 18 else 'æœªæˆå¹´'</code>æ‰è¡Œäº†ã€‚å½“ç„¶è¿™åªæ˜¯ç†æƒ³æƒ…å†µï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸€å¼ ä¸šåŠ¡è¡¨å¯èƒ½ä¼šæœ‰ 100 å¤šä¸ªå­—æ®µï¼Œå¯¼å‡ºçš„æ—¶å€™å¯èƒ½è¦ä»è¿™ 100 å¤šä¸ªå­—æ®µä¸­é€‰æ‹© 80 å¤šä¸ªå¯¼å‡ºæ¥ç„¶åè¿˜è¦å¯¼å‡ºä»–ä»¬å¤–é”®å…³è”çš„å…¶ä»–è¡¨çš„æ•°æ®ã€‚è¿™æ˜¯ç”±ä¸Šé¢è¿™ç§å†™æ³•å°±ä¼šè¶Šæ¥è¶Šé•¿ï¼Œè€Œä¸”å°¤å…¶æ˜¯å½“â€ä¸èƒ½ä»æ•°æ®åº“ä¸­ç›´æ¥å–â€œçš„æ•°æ®è¶Šæ¥è¶Šå¤šçš„æ—¶å€™å°±ä¼šéº»çƒ¦äº†ã€‚ä¸‹é¢ä»‹ç»çš„è¿™ç§ä½¿ç”¨ djcsv å¯¼å‡ºçš„æ–¹æ³•å°±å¾ˆå¥½ç”¨äº†ã€‚</p><h1 id=0x02-ä½¿ç”¨-djcsv-å¯¼å‡º>0X02 ä½¿ç”¨ djcsv å¯¼å‡º</h1><p>è¿™ç§æ–¹æ³•éœ€è¦å®‰è£…ä¸€ä¸ªä¸‰æ–¹åº“ djcsv ï¼Œé¡¾åæ€ä¹‰å®ƒå°±æ˜¯ç”¨æ¥æ–¹ä¾¿ Django å¯¼å‡º csv æ–‡ä»¶çš„ã€‚è¿™å¨ä»£ç çš„å…·ä½“è§£é‡Šå°±ç›´æ¥å†™åœ¨ä¸‹é¢æ³¨é‡Šé‡Œäº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#f92672>from</span> djcsv <span style=color:#f92672>import</span> write_csv
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>export_csv</span>():
</span></span><span style=display:flex><span>        queryset <span style=color:#f92672>=</span> Student<span style=color:#f92672>.</span>objects<span style=color:#f92672>.</span>all()
</span></span><span style=display:flex><span>        queryset_values <span style=color:#f92672>=</span> queryset<span style=color:#f92672>.</span>values(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;name&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;gender&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;birthday&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;teacher__name&#39;</span>,    <span style=color:#75715e># è·¨è¡¨ä¹Ÿæ˜¯å¯ä»¥çš„</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;teacher__gender&#39;</span>,
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># å¯¼å‡ºå­—æ®µè¡¨å¤´</span>
</span></span><span style=display:flex><span>        field_header_map <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;å§“å&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;gender&#39;</span>: <span style=color:#e6db74>&#39;æ€§åˆ«&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;birthday&#39;</span>: <span style=color:#e6db74>&#39;ç”Ÿæ—¥&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;teacher__name&#39;</span>: <span style=color:#e6db74>&#39;è€å¸ˆå§“å&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;teacher__gender&#39;</span>: <span style=color:#e6db74>&#39;è€å¸ˆæ€§åˆ«&#39;</span>,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># æ ¼å¼åŒ–æ•°æ®</span>
</span></span><span style=display:flex><span>        gender_dict <span style=color:#f92672>=</span> dict(Student<span style=color:#f92672>.</span>GENDER_CHOICES)
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        Student.GENDER_CHOICES = (
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            (&#39;M&#39;, &#39;ç”·&#39;),
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            (&#39;F&#39;, &#39;å¥³),
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        )
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        field_serializer_map <span style=color:#f92672>=</span> {    <span style=color:#75715e># æŠ˜é¡µæœºå°±æ˜¯ä¸ºä»€ä¹ˆè¦å« serializer çš„æ–¹æ³•äº†ï¼Œå› ä¸ºç¡®å®æœ‰ä¸€ä¸ªç¿»è¯‘åœ¨è¿™å„¿</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;gender&#39;</span>: (<span style=color:#66d9ef>lambda</span> x: gender_dict<span style=color:#f92672>.</span>get(x, <span style=color:#e6db74>&#39;å…¶ä»–&#39;</span>)),
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;teacher_gender&#39;</span>: (<span style=color:#66d9ef>lambda</span> x: gender_dict<span style=color:#f92672>.</span>get(x, <span style=color:#e6db74>&#39;å…¶ä»–&#39;</span>)),
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;export.csv&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> csv_file:
</span></span><span style=display:flex><span>            write_csv(
</span></span><span style=display:flex><span>                queryset_values,
</span></span><span style=display:flex><span>                csv_file,
</span></span><span style=display:flex><span>                field_header_map<span style=color:#f92672>=</span>field_header_map,
</span></span><span style=display:flex><span>                field_serializer_map<span style=color:#f92672>=</span>field_serializer_map
</span></span><span style=display:flex><span>            )
</span></span></code></pre></div></div><style>.reward-container{max-width:500px;margin:50px auto;padding:30px;text-align:center;background:0 0;border-radius:12px}.reward-title{font-size:20px;margin-bottom:30px}.reward-icons{display:flex;justify-content:center;gap:40px}.reward-item{position:relative;cursor:pointer}.reward-item img{width:60px;height:60px;transition:transform .3s}.reward-item:hover img{transform:scale(1.1)}.qrcode{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);background:#fff;padding:15px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,.15);opacity:0;visibility:hidden;transition:all .3s}.reward-item:hover .qrcode{opacity:1;visibility:visible}.qrcode img{width:200px;height:200px;display:block}</style><div class=reward-container><div class=reward-title>â˜• å¦‚æœå–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæ¬¢è¿æ‰“èµ 5 æ¯›é’±</div><div class=reward-icons><div class=reward-item><img src=/alipay-logo.png alt=æ”¯ä»˜å®><div class=qrcode><img src=/alipay-qr.jpeg alt=æ”¯ä»˜å®äºŒç»´ç ></div></div><div class=reward-item><img src=/trc20-logo.png alt=USDT><div class=qrcode><img src=/usdt-qr.jpeg alt=USDTäºŒç»´ç ></div></div><div class=reward-item><img src=/wechatpay-logo.png alt=å¾®ä¿¡><div class=qrcode><img src=/wechat-qr.jpeg alt=å¾®ä¿¡äºŒç»´ç ></div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>æ›´æ–°äº 2025-01-16</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/django/>Django</a>,&nbsp;<a href=/tags/csv/>CSV</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>è¿”å›</a></span>&nbsp;|&nbsp;<span><a href=/>ä¸»é¡µ</a></span></section></div><div class=post-nav><a href=/posts/django-api-fater-2/ class=prev rel=prev title="å¦‚ä½•è®© Django API å†å¿«ä¸€ç‚¹ (2)"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>å¦‚ä½•è®© Django API å†å¿«ä¸€ç‚¹ (2)</a>
<a href=/posts/why-django-need-uwsgi/ class=next rel=next title="ä¸ºä»€ä¹ˆ Django éœ€è¦uWSGI">ä¸ºä»€ä¹ˆ Django éœ€è¦uWSGI<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=gitalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/gitalk/gitalk></a>Gitalk</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Shawn ğŸ’— Amber</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2015 - 2025</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.programmer.work target=_blank>Shawn</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=å›åˆ°é¡¶éƒ¨><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=æŸ¥çœ‹è¯„è®º><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/gitalk/gitalk.min.7a92033a32beba2a57cd417e2d5ab7ac2a45bf5111227648ac274b81e6a6cf57.css integrity="sha256-epIDOjK+uipXzUF+LVq3rCpFv1ERInZIrCdLgeamz1c="><link rel=stylesheet href=/lib/katex/katex.min.76e39bd605d45b2d1944123c66608b0c8bb9baeb70720b212571531c7cf9bc2a.css integrity="sha256-duOb1gXUWy0ZRBI8ZmCLDIu5uutwcgshJXFTHHz5vCo="><link rel=stylesheet href=/some.4187f1011616875f9033a8af97475eb55b97ed2f80267e22df0cd8305de45cc8.css integrity="sha256-QYfxARYWh1+QM6ivl0detVuX7S+AJn4i3wzYMF3kXMg="><script type=text/javascript src=/lib/gitalk/gitalk.min.3e68fce688cb68f396c11b65309c267b307f420f01cef269e5e4f3bd769801f0.js integrity="sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.3d9120fa621da6d613c1698b7014ec6bdf4620366e8f2b7b547059f4b6f6272b.js integrity="sha256-PZEg+mIdptYTwWmLcBTsa99GIDZujyt7VHBZ9Lb2Jys="></script><script type=text/javascript src=/lib/clipboard/clipboard.min.e17a1d816e13c0826e0ed7febfabc3277f45571234bde0bf9120829a7169edc9.js integrity="sha256-4XodgW4TwIJuDtf+v6vDJ39FVxI0veC/kSCCmnFp7ck="></script><script type=text/javascript src=/lib/katex/katex.min.eb18207487161674e717087c317db14ac1a62dadaecccb802499ce173bfeb739.js integrity="sha256-6xggdIcWFnTnFwh8MX2xSsGmLa2uzMuAJJnOFzv+tzk="></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.cb7f4ca60ed5dc3e258415f8c7a3b46d4a93578a52adf83011f18a7f190e7602.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.52ce78fab4860d24ef22128a52ce24ca01368a9034457a565a1d3fccbab0ddbb.js integrity="sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.5c0a121a8b490afc85860a522347aeb34fb508c6b23044e5d29f6b2194227b51.js integrity="sha256-XAoSGotJCvyFhgpSI0eus0+1CMayMETl0p9rIZQie1E="></script><script type=text/javascript>window.config={code:{copyTitle:"å¤åˆ¶åˆ°å‰ªè´´æ¿",maxShownLines:50},comment:{gitalk:{admin:["shawn-bluce"],clientID:"Ov23ligzD7mU8WBsue6H",clientSecret:"a832d1ba967e3a40f5485aa05e2a9e76f2d77901",id:"2020-06-28T14:40:00Z",owner:"shawn-bluce",repo:"shawn-bluce.github.io",title:"Django ç›¸å¯¹ä¼˜é›…åœ°å¯¼å‡º CSV"}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.612a51a43205bbcf3b4af348dc2e8aa60f77f4fe5535ebc57f13054b61607d6c.js integrity="sha256-YSpRpDIFu887SvNI3C6Kpg939P5VNevFfxMFS2FgfWw="></script></body></html>